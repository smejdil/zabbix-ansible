<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.0</version>
    <date>2024-01-10T15:31:08Z</date>
    <groups>
        <group>
            <uuid>7df96b18c230490a9a0a9e2307226338</uuid>
            <name>Templates</name>
        </group>
    </groups>
    <templates>
        <template>
            <uuid>f146bbe8f7394bc1a8b6eea78f40596e</uuid>
            <template>FreeBSD bhyve by Zabbix agent</template>
            <name>FreeBSD bhyve by Zabbix agent</name>
            <description>This dev template for bhyve uses pull request vm-bhyve
https://github.com/churchers/vm-bhyve/pull/402

# get branche json-list from guthub user runhyve
cd /opt
git clone -b json-lists https://github.com/runhyve/vm-bhyve

# zbx agent
cat /usr/local/etc/zabbix6/zabbix_agentd.conf.d/zbx.bhyve.conf
UserParameter=zbx.bhyve.vm.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-list
UserParameter=zbx.bhyve.vm.switch.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-switch-list
UserParameter=zbx.bhyve.vm.datastore.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-datastore-list

# sudo
cat /usr/local/etc/sudoers.d/zabbix
zabbix      ALL=NOPASSWD: /usr/local/bin/zabbix-bhyve-list, /usr/local/bin/zabbix-bhyve-switch-list, /usr/local/bin/zabbix-bhyve-datastore-list

# example cmd
cat /usr/local/bin/zabbix-bhyve-list
#!/bin/sh

cd /opt/vm-bhyve
/opt/vm-bhyve/vm list -j
name: Open-Tech
version: 7.0-0</description>
            <groups>
                <group>
                    <name>Templates</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>e6eaa503eaa343d395e0967f3797f011</uuid>
                    <name>Get bhyve datastores</name>
                    <key>zbx.bhyve.vm.datastore.list</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>vm datastore list -j</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.datastores</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>589b0ad324ec47b5976a60d3ee90ff4a</uuid>
                    <name>Get bhyve machines</name>
                    <key>zbx.bhyve.vm.list</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>vm list -j</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.machines</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>241e706e060241989f296f9ae3e7aba6</uuid>
                    <name>Get bhyve switches</name>
                    <key>zbx.bhyve.vm.switch.list</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <description>vm switch list -j</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.switches</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>e0efb89ede6543b78b00f387512cad9c</uuid>
                    <name>Discovery bhyve datastore</name>
                    <type>DEPENDENT</type>
                    <key>zbx.bhyve.vm.datastore</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#BHYVE_DATASTORE_NAME}</macro>
                                <value>{$BHYVE.DATASTORE.NAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#BHYVE_DATASTORE_NAME}</macro>
                                <value>{$BHYVE.DATASTORE.NAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description>UserParameter=zbx.bhyve.vm.switch.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-switch-list</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>9e21b319542748fea058d55febb7c1c0</uuid>
                            <name>VM Datastore {#BHYVE_DATASTORE_NAME} dataset</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.datastore.dataset[{#BHYVE_DATASTORE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_DATASTORE_NAME}')].dataset.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.datastore.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>datastore</value>
                                </tag>
                                <tag>
                                    <tag>datastore</tag>
                                    <value>dataset</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a3a24032d62e4507a2b42b1b56be6cb8</uuid>
                            <name>VM Datastore {#BHYVE_DATASTORE_NAME} name</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.datastore.name[{#BHYVE_DATASTORE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_DATASTORE_NAME}')].name.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.datastore.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>datastore</value>
                                </tag>
                                <tag>
                                    <tag>datastore</tag>
                                    <value>name</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>1108632aa96c49fca6436cca226e16e3</uuid>
                            <name>VM Datastore {#BHYVE_DATASTORE_NAME} path</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.datastore.path[{#BHYVE_DATASTORE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_DATASTORE_NAME}')].path.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.datastore.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>datastore</value>
                                </tag>
                                <tag>
                                    <tag>datastore</tag>
                                    <value>path</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a6c40b7c08e540a3829098e79e097753</uuid>
                            <name>VM Datastore {#BHYVE_DATASTORE_NAME} type</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.datastore.type[{#BHYVE_DATASTORE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_DATASTORE_NAME}')].type.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.datastore.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>datastore</value>
                                </tag>
                                <tag>
                                    <tag>datastore</tag>
                                    <value>type</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>zbx.bhyve.vm.datastore.list</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#BHYVE_DATASTORE_NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>90989aae52a5434d806f8b4a26304cc7</uuid>
                    <name>Discovery bhyve machines</name>
                    <type>DEPENDENT</type>
                    <key>zbx.bhyve.vm.machines</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#BHYVE_NAME}</macro>
                                <value>{$BHYVE.NAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#BHYVE_NAME}</macro>
                                <value>{$BHYVE.NAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description>UserParameter=zbx.bhyve.vm.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-list</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>9b6b9098d14e4cd2aae06f64a107f3a2</uuid>
                            <name>VM Host {#BHYVE_NAME} auto</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.auto[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].auto.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>auto</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>ceb3091caa624c19825db1fffa39df84</uuid>
                            <name>VM Host {#BHYVE_NAME} cpu</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.cpu[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].cpu.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>cpu</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>033a998399854756a0e76093a78134fe</uuid>
                            <name>VM Host {#BHYVE_NAME} datastore</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.datastore[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].datastore.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>datastore</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>a1471cd9d3764bfd9bfb8203f8e5b3fb</uuid>
                            <name>VM Host {#BHYVE_NAME} loader</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.loader[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].loader.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>loader</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>af650fbdd1864fa3b7ed634ea7242e04</uuid>
                            <name>VM Host {#BHYVE_NAME} memory</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.memory[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].memory.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>memory</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3427efb6339f4fcd8a30c8b98e5f56d0</uuid>
                            <name>VM Host {#BHYVE_NAME} name</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.name[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].name.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>name</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>896d2a7a05b3451db9a1fb5e84bfe4d2</uuid>
                            <name>VM Host {#BHYVE_NAME} state</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.state[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].state.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>state</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>0a0d8c755a0f40a3ba3cbd9219a64a6f</uuid>
                            <name>VM Host {#BHYVE_NAME} vnc</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.vnc[{#BHYVE_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_NAME}')].vnc.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>vnc</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <trigger_prototypes>
                        <trigger_prototype>
                            <uuid>530436b143884a7e802d6e97a78207e2</uuid>
                            <expression>find(/FreeBSD bhyve by Zabbix agent/zbx.bhyve.vm.state[{#BHYVE_NAME}],,&quot;like&quot;,&quot;Stopped&quot;)=1 and find(/FreeBSD bhyve by Zabbix agent/zbx.bhyve.vm.auto[{#BHYVE_NAME}],,&quot;like&quot;,&quot;Yes&quot;)=1</expression>
                            <name>VM Host {#BHYVE_NAME} is not running</name>
                            <priority>WARNING</priority>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>running</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                        <trigger_prototype>
                            <uuid>3e6f20f4d2e64435859ffe6dd8cc345c</uuid>
                            <expression>find(/FreeBSD bhyve by Zabbix agent/zbx.bhyve.vm.state[{#BHYVE_NAME}],,&quot;like&quot;,&quot;Running&quot;)=1 and find(/FreeBSD bhyve by Zabbix agent/zbx.bhyve.vm.auto[{#BHYVE_NAME}],,&quot;like&quot;,&quot;No&quot;)=1</expression>
                            <name>VM Host {#BHYVE_NAME} is running without auto start</name>
                            <priority>INFO</priority>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>auto</value>
                                </tag>
                            </tags>
                        </trigger_prototype>
                    </trigger_prototypes>
                    <master_item>
                        <key>zbx.bhyve.vm.list</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#BHYVE_NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
                <discovery_rule>
                    <uuid>5a38190b9c474642af17f82c8568a60e</uuid>
                    <name>Discovery bhyve switches</name>
                    <type>DEPENDENT</type>
                    <key>zbx.bhyve.vm.switches</key>
                    <delay>0</delay>
                    <filter>
                        <evaltype>AND</evaltype>
                        <conditions>
                            <condition>
                                <macro>{#BHYVE_SWITCH_NAME}</macro>
                                <value>{$BHYVE.SWITCH.NAME.MATCHES}</value>
                                <formulaid>A</formulaid>
                            </condition>
                            <condition>
                                <macro>{#BHYVE_SWITCH_NAME}</macro>
                                <value>{$BHYVE.SWITCH.NAME.NOT_MATCHES}</value>
                                <operator>NOT_MATCHES_REGEX</operator>
                                <formulaid>B</formulaid>
                            </condition>
                        </conditions>
                    </filter>
                    <lifetime>1d</lifetime>
                    <description>UserParameter=zbx.bhyve.vm.switch.list,/usr/local/bin/sudo /usr/local/bin/zabbix-bhyve-switch-list</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>30b94e69e40b47a397e911b6b5c3b04f</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} address</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.address[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].address.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>address</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>483a0b2336344b2d99469c918473db2c</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} iface</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.iface[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].iface.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>iface</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>db42e2337999421ab7fd7e5156798c64</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} mtu</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.mtu[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].mtu.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>mtu</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>fd4e411a062749d4bee79efd7f8a957c</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} name</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.name[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].name.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>name</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>68c619f640c74c7995a62520d24b70e0</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} ports</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.ports[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].ports.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>ports</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>7578be69b8494d3698c84ef40bdb5b72</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} private</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.private[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].private.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>private</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>99198153dde74c9891bd0abd6772ef3a</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} type</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.type[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].type.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>type</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>6a8d29997ee1474f9554e38d32ad359b</uuid>
                            <name>VM Switch {#BHYVE_SWITCH_NAME} vlan</name>
                            <type>DEPENDENT</type>
                            <key>zbx.bhyve.vm.switch.vlan[{#BHYVE_SWITCH_NAME}]</key>
                            <delay>0</delay>
                            <trends>0</trends>
                            <value_type>CHAR</value_type>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.[?(@.name=='{#BHYVE_SWITCH_NAME}')].vlan.first()</parameter>
                                    </parameters>
                                </step>
                                <step>
                                    <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                                    <parameters>
                                        <parameter>1h</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>zbx.bhyve.vm.switch.list</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>bhyve</tag>
                                    <value>switches</value>
                                </tag>
                                <tag>
                                    <tag>switches</tag>
                                    <value>vlan</value>
                                </tag>
                                <tag>
                                    <tag>target</tag>
                                    <value>bhyve</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <master_item>
                        <key>zbx.bhyve.vm.switch.list</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#BHYVE_SWITCH_NAME}</lld_macro>
                            <path>$.name</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>vm</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>bhyve</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$BHYVE.DATASTORE.NAME.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$BHYVE.DATASTORE.NAME.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
                <macro>
                    <macro>{$BHYVE.NAME.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$BHYVE.NAME.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
                <macro>
                    <macro>{$BHYVE.SWITCH.NAME.MATCHES}</macro>
                    <value>^.*$</value>
                </macro>
                <macro>
                    <macro>{$BHYVE.SWITCH.NAME.NOT_MATCHES}</macro>
                    <value>CHANGE_IF_NEEDED</value>
                </macro>
            </macros>
        </template>
    </templates>
</zabbix_export>
